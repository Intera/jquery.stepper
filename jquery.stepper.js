jQuery.fn.stepper=function(config){var defaultConfig={stepConfig:{},animation:"fadeIn",onStepChange:function(from,to,stepper,nextStep){return true},onAfterStepChange:function(from,to,stepper,nextStep){},forwardButton:function(step){return step.find(".nextStep")},backButton:function(step){return step.find(".prevStep")}};var config=$.extend(defaultConfig,config);function getButton(config,step){if($.isFunction(config))return config(step);else return typeof config=="string"?$(config):config}var stepper={activeStepNumber:1,stepConfig:config.stepConfig,container:this,onStepChange:config.onStepChange,onAfterStepChange:config.onAfterStepChange,defaultAnimation:config.animation,animationSpeed:config.animationSpeed||190,numberOfSteps:0,get:function(number){if(this.stepConfig&&this.stepConfig[number]){return this.stepConfig[number]}else{return this.container.find(".step"+number)}},nextStep:function(){this.showStep(this.activeStepNumber+1)},prevStep:function(){this.showStep(this.activeStepNumber-1)},disableButtonEvents:function(){var step=this.get(this.activeStepNumber);getButton(config.forwardButton).add(getButton(config.backButton)).off("click.stepper")},enableButtonEvents:function(){this.setButtonEvents(this.get(this.activeStepNumber))},setButtonEvents:function(step){getButton(config.forwardButton,step).off("click.stepper").on("click.stepper",function(event){stepper.nextStep();return false});getButton(config.backButton,step).off("click.stepper").on("click.stepper",function(event){stepper.prevStep();return false});return step},hideAll:function(){if(this.stepConfig){var t=this.stepConfig;for(var key in t){if(t.hasOwnProperty(key)){t[key].hide()}}}this.container.hide().find(".step").hide();return this},init:function(){for(step in this.stepConfig){if(this.stepConfig.hasOwnProperty(step)){this.numberOfSteps+=1}}this.numberOfSteps+=this.container.find(".step").length;this.hideAll();return this},showStep:function(number){var nextStep=this.get(number);if(this.onStepChange(this.activeStepNumber,number,this,nextStep)){this.hideAll();if(number<2){getButton(config.backButton).hide();getButton(config.forwardButton).show()}else if(number>=this.numberOfSteps){getButton(config.forwardButton).hide();getButton(config.backButton).show()}var nextStep=this.setButtonEvents(nextStep);var nextStepContainer=nextStep.parent("div").show();var n=nextStep;var previousStepNumber=stepper.activeStepNumber;function onComplete(){config.onAfterStepChange(previousStepNumber,number,stepper,nextStep)}if(this.defaultAnimation){var da=this.defaultAnimation;if("fadeIn"==da){n.fadeIn(this.animationSpeed,onComplete)}else if("slideDown"==da){n.slideDown(this.animationSpeed,onComplete)}else if("slideUp"==da){n.slideUp(this.animationSpeed,onComplete)}else{n.show(this.animationSpeed,onComplete)}}else{n.show(this.animationSpeed,onComplete)}this.activeStepNumber=number}return this},showFirstStepThatContains:function(selector){var step=1;var stepContainingElement=false;while(step<=this.numberOfSteps){var stepItem=this.get(step);if(stepItem.length){if(stepItem.find(selector).length){this.showStep(step);break}}step++}return this}};return stepper.init()};